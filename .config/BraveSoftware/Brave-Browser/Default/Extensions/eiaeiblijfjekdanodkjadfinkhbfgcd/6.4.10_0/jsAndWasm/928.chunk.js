try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="dca3e44e-1d5f-42e5-9ebe-5c9f6058b295",e._sentryDebugIdIdentifier="sentry-dbid-dca3e44e-1d5f-42e5-9ebe-5c9f6058b295")}()}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"6.4.10"},(self.webpackChunknordpass=self.webpackChunknordpass||[]).push([[928],{36928:(e,s,n)=>{n.r(s),n.d(s,{EmergencyAccess:()=>B});var a=n(74848),t=n(96540),r=n(58065),c=n(47767),l=n(92561),i=n(1876),d=n(90895),o=n(35389),u=n(24291),m=n(15193),x=n(9908),f=n(13123),g=n(91120),b=n(18),h=n(90867),p=n(65125),y=n(49374),v=n(32980),E=n(6442);const j=["Enter",",",";"," "];var C=n(78522),A=n(89389),w=n(69883),k=n(92067),N=n(55910);const S=({className:e,emailChips:s,onChange:n,onBlur:t,onKeyDown:r,inputValue:c,placeholder:l,hasTopBorder:i,scrollableDivRef:d,inputRef:o,onFocus:u,children:m})=>{const{formatMessage:x}=(0,E.A)();return(0,a.jsxs)("div",{className:(0,N.cx)("flex items-center justify-between px-6 border-b border-grey-lighter dark:border-[--dmd-3]",i&&"border-t",e),children:[(0,a.jsx)("div",{className:"mr-1 mt-4 h-6 self-start whitespace-nowrap leading-6 text-grey-darker dark:text-white",children:(0,a.jsx)(g.WIv,{className:"text-ref-color-grey-50"})}),(0,a.jsx)("div",{ref:d,className:"max-h-30 flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex flex-wrap py-3",children:[s,(0,a.jsx)("input",{autoFocus:!0,ref:o,value:c,className:"m-1 h-6 min-w-45 flex-1 resize-none overflow-y-auto overflow-x-hidden bg-inherit text-sm font-medium leading-normal outline-none placeholder:text-grey focus:text-grey-darker dark:placeholder:text-ref-color-grey-50 dark:focus:text-white",id:"emails","data-testid":"email-input",placeholder:null!=l?l:x({id:"enterEmailAddressLabel"}),onChange:e=>n(e.target.value),onKeyDown:r,onFocus:u,onBlur:t})]})}),m]})};var R=n(53353),_=n(3428);const D=({message:e})=>(0,a.jsx)("div",{className:"invalid -mx-6 flex justify-center border-t border-grey-lighter bg-red/20 px-6 py-3 align-middle dark:border-[--dmd-3]",children:(0,a.jsx)("span",{"data-testid":"error-message",className:"text-xs leading-[18px] text-red",children:e})}),G=({title:e,email:s,onRemove:n,isInvalid:t})=>(0,a.jsx)(g.vu3,{type:t?"danger":"primary",classNames:"ml-1 mt-1 max-w-[185px]",icon:"close",dataTestId:`email-chip-${s}-remove-button`,message:e||s,onClick:()=>n(s)}),I=({onGiveAccessSuccess:e})=>{const[s,n]=(0,t.useState)(""),[c,l]=(0,t.useState)([]),[i,o]=(0,t.useState)([]),[m,x]=(0,t.useState)(""),{formatMessage:f}=(0,E.A)(),{scrollableElementRef:g}=(e=>{const s=(0,t.useRef)(null),n=(0,_.ZC)(e,0);return(0,t.useEffect)(()=>{n<=e&&s.current&&(s.current.scrollTop=s.current.scrollHeight)},[n,e]),{scrollableElementRef:s}})(c.length),b=(0,u.d4)(w.JQ),y=(0,A.$)(),{action:v,isLoading:N}=(0,C.y)(h.FH.emergencyAccess.giveEmergencyAccess,{onSuccess:()=>{e(),h.FH.action.save(d.ay.EmergencyAccessSuccess)},onError:({info:{non_existing_users:e=[],organization_users:s=[]}={},message:n})=>{o([...e||[],...s||[]]),x(n)}});(0,t.useEffect)(()=>{(c.every(e=>!i.includes(e))&&i.length>0||c.length<1)&&x("")},[c,i]);const I=(0,t.useCallback)(e=>e.includes(s)?e:[...e,s],[s]),T=(0,t.useCallback)(e=>{e===b?(o(I),x(f({id:"cannotGiveAccessToYourself"}))):i.includes(e)&&x(f({id:"cannotGiveAccess"}))},[i,b,I]),M=(0,t.useCallback)(()=>{(0,k.xf)(s)&&(l(I),n(""),T(s))},[s,I,T]),F=(0,t.useCallback)(e=>{l(s=>s.filter(s=>s!==e))},[]);return(0,a.jsxs)(a.Fragment,{children:[m&&(0,a.jsx)(D,{message:m}),(0,a.jsxs)("form",{noValidate:!0,className:"text-sm font-medium leading-normal text-grey-darker",onSubmit:s=>{s.preventDefault(),(0,p.c)(()=>v(c)),y||e()},children:[(0,a.jsx)(S,{className:"-mx-6",scrollableDivRef:g,emailChips:c.map(e=>(0,a.jsx)(G,{title:e,email:e,isInvalid:i.includes(e),onRemove:F},e)),inputValue:s,hasTopBorder:!m,onKeyDown:e=>{const a="Enter"===e.key&&!s&&c.length>0;if(j.includes(e.key)&&!a)e.preventDefault(),M();else if("Backspace"===e.key&&""===s){e.preventDefault();const s=c.slice(0),a=s.pop();l(s),n(a||"")}},onBlur:M,onChange:n}),(0,a.jsx)("div",{className:"flex justify-end pt-6",children:(0,a.jsx)(R.w,{buttonText:(0,a.jsx)(r.A,{id:"giveAccess"}),isLoading:N,isDisabled:c.length<1||!!m})})]})]})},T=({onClose:e})=>(0,a.jsxs)(v.z,{close:e,shouldCloseOnOverlayClick:!1,className:"w-[600px]",title:(0,a.jsx)(r.A,{id:"giveAccess"}),children:[(0,a.jsx)("div",{className:"pb-6 text-xs leading-[18px] tracking-[-.01em] text-grey-dark dark:text-[--dmd-1]",children:(0,a.jsx)(r.A,{id:"giveAccessDescription",values:{numberOfDays:y.tP}})}),(0,a.jsx)(I,{onGiveAccessSuccess:e})]}),M=({children:e,onGiveAccess:s,isDisabled:n})=>(0,a.jsx)("div",{className:"border-b border-grey-lighter px-12 dark:border-[--dmd-3]",children:(0,a.jsxs)("div",{className:"mx-auto flex min-h-[34px] w-full max-w-[1000px] items-center justify-between",children:[(0,a.jsx)("div",{className:"flex",children:e}),(0,a.jsx)(g.m_M,{title:n?(0,a.jsx)(r.A,{id:"premiumFeature"}):null,placement:"top",children:(0,a.jsx)("span",{children:(0,a.jsx)(g.$nd,{rank:"primary","data-testid":"emergency-access-give-access-button",disabled:n,onClick:s,children:(0,a.jsx)(r.A,{id:"giveEmergencyAccessButton"})})})})]})});var F=n(58997);const B=()=>{const e=(0,u.wA)(),s=(0,c.Zp)(),n=!!(0,c.RQ)(i.bw.EMERGENCY_ACCESS_GIVEN),v=!!(0,c.RQ)(i.bw.EMERGENCY_ACCESS_RECEIVED),[E,j]=(0,t.useState)(!1),[C,A]=(0,t.useState)(v?1:0),w=(0,u.d4)(m._E).some(e=>e.status===y.YS.Pending),{isFreeUser:k}=(0,o.d)();return(0,t.useEffect)(()=>{n||v||s(i.bw.EMERGENCY_ACCESS_GIVEN,{replace:!0})},[n,v,s]),(0,t.useEffect)(()=>{s(0===C?i.bw.EMERGENCY_ACCESS_GIVEN:i.bw.EMERGENCY_ACCESS_RECEIVED)},[C,s]),(0,a.jsxs)(F.M,{headerContent:(0,a.jsx)(r.A,{id:"emergencyAccess"}),subHeaderContent:(0,a.jsx)(M,{isDisabled:(0,f.C)(k),onGiveAccess:()=>{(0,p.c)(()=>{h.FH.action.save(d.ay.EmergencyAccessGiveAccessTap),k?e((0,b.LQ)({type:x.q.PremiumUpgrade,metadata:{source:l.E.EmergencyAccess}})):j(!0)})},children:(0,a.jsxs)(g.tUM,{activeKey:C,size:"large",onChange:A,children:[(0,a.jsx)(g.ozo,{tabKey:0,"data-testid":"emergency-access-given-tab",children:(0,a.jsx)(r.A,{id:"emergencyAccessGivenTab"})}),(0,a.jsx)(g.ozo,{tabKey:1,"data-testid":"emergency-access-received-tab",hasIndicator:w,children:(0,a.jsx)(r.A,{id:"emergencyAccessReceivedTab"})})]})}),onGoBack:()=>s(i.bw.SETTINGS),children:[(0,a.jsx)(c.sv,{}),E&&(0,a.jsx)(T,{onClose:()=>j(!1)})]})}}}]);
//# sourceMappingURL=928.chunk.js.map
try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7f107a4b-cc3b-4642-904e-554574158b57",e._sentryDebugIdIdentifier="sentry-dbid-7f107a4b-cc3b-4642-904e-554574158b57")}()}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"6.4.10"},(self.webpackChunknordpass=self.webpackChunknordpass||[]).push([[628],{45298:(e,t,o)=>{"use strict";o.r(t),o.d(t,{TotpModalsHandler:()=>oe});var n=o(74848),s=o(96540),r=o(64012),i=o(73890),a=o(65238),l=o(24291),c=o(9908),d=o(37380),u=o(89889),p=o(35860),f=o(34354),b=o(28437),m=o(90867),x=o(58065),h=o(6442),y=o(35763),j=o(45847),v=o(78522),g=o(91120),A=o(92067),w=o(64117),S=o(47767),C=o(1876),O=o(69223);const E=(e=!1)=>{const t=!!(0,S.RQ)(C.bw.EDIT_ITEM(":id")),o=(0,l.d4)(O.g4),[n,r]=(0,s.useState)(),[i,a]=(0,s.useState)();return(0,s.useEffect)(()=>{t&&!e&&(o||e||(a(2),r(1)),o&&r(2))},[o,t,e]),[n,i]},I=[(0,n.jsx)(x.A,{id:"addTwoFactoCodeInstructionStep1"},"addTwoFactoCodeInstructionStep1"),(0,n.jsx)(x.A,{id:"addTwoFactoCodeInstructionStep2"},"addTwoFactoCodeInstructionStep2"),(0,n.jsx)(x.A,{id:"addTwoFactoCodeInstructionStep3"},"addTwoFactoCodeInstructionStep3")],T=e=>{var{itemId:t,onClose:o,hasMfaValue:r}=e,i=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(o[n[s]]=e[n[s]])}return o}(e,["itemId","onClose","hasMfaValue"]);const{formatMessage:a}=(0,h.A)(),[l,d]=(0,s.useState)(""),[u,p]=E(r),f=()=>{(0,j.$)(a({id:"addingTwoFactorCodeFailure"}))},{removeFromQueue:b}=(0,w.O)(),{action:S,isLoading:C}=(0,v.y)(m.FH.mfa.uploadData,{onError:f,onSuccess:()=>{(0,y.P0)(y.Et.ActionFeedback,{bodyText:a({id:"addingTwoFactorCodeSuccess"})}),b(c.q.AddTwoFactorCode)}});return(0,n.jsxs)(g.lGe,Object.assign({},i,{isClosable:!0,isBorderless:!0,shouldCloseOnOverlayClick:!1,className:"min-h-[481px]","data-testid":"add-two-factor-code-dialog",onClose:o,children:[(0,n.jsx)(g.c75,{className:"h-[191px] bg-[url('@images/backgrounds/add-two-factor-code.svg?url')]",title:""}),(0,n.jsx)(g.R4S,{className:"min-h-[218px] pt-7",children:(0,n.jsx)("form",{onSubmit:e=>{return n=function*(){e.stopPropagation(),e.preventDefault();const o=(0,A.Vu)(l.toUpperCase());(0,A.vP)(o)?yield S(o,t):f()},new((o=void 0)||(o=Promise))(function(e,t){function s(e){try{i(n.next(e))}catch(e){t(e)}}function r(e){try{i(n.throw(e))}catch(e){t(e)}}function i(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o(function(e){e(n)})).then(s,r)}i((n=n.apply(undefined,[])).next())});var o,n},children:(0,n.jsxs)("fieldset",{className:"flex flex-col justify-start",disabled:C,children:[u&&p&&(0,n.jsx)("p",{className:"mb-1 text-xs font-medium text-ref-color-grey-65",children:(0,n.jsx)(x.A,{id:"stepOf",values:{currentStep:u,totalSteps:p}})}),(0,n.jsx)("p",{className:"text-xl font-bold lowercase first-letter:uppercase",children:(0,n.jsx)(x.A,{id:"addTwoFactorCode"})}),(0,n.jsx)("p",{className:"mb-5 text-sm leading-normal",children:(0,n.jsx)(x.A,{id:"addTwoFactorCodeDescription"})}),(0,n.jsx)("p",{className:"mb-5 text-sm font-bold leading-normal",children:(0,n.jsx)(x.A,{id:"addTwoFactorCodeInstructionTitle"})}),(0,n.jsx)("ol",{className:"mb-5 flex flex-col gap-3",children:I.map((e,t)=>(0,n.jsx)("li",{className:"relative [counter-increment:list] before:top-0 before:mr-3 before:inline-flex before:size-6 before:items-center before:justify-center before:rounded-full before:bg-grey-lighter before:text-center before:font-bold before:content-[counter(list)] dark:before:bg-ref-color-grey-90",children:e},`step${t+1}`))}),(0,n.jsx)(g.pde,{autoFocus:!0,autoComplete:"off",id:"setupKey",value:l,label:a({id:"setupKey"}),onChange:d}),(0,n.jsxs)("div",{className:"flex grow items-center justify-between py-5",children:[(0,n.jsx)(g.N_E,{isTargetBlank:!0,href:"https://support.nordpass.com/hc/en-us/articles/13876344728849-How-to-set-up-2FA-codes-with-NordPass-Authenticator",children:(0,n.jsx)(x.A,{id:"needHelpQuestion"})}),(0,n.jsx)(g.$nd,{disabled:!l.length,isLoading:C,type:"submit",rank:"primary","data-testid":"confirm",children:(0,n.jsx)(x.A,{id:"continue"})})]})]})})})]}))};var F,D=o(72311);!function(e){e.Settings="settings",e.AddItem="add_item",e.AccessItem="access_item"}(F||(F={}));const N=e=>{switch(e){case F.Settings:return(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledTitleVersionSettings"});case F.AddItem:return(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledTitleVersionAddItem"});case F.AccessItem:return(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledTitleVersionAccessItem"});default:return null}},k=e=>{switch(e){case F.Settings:return(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledDescriptionVersionSettings"});case F.AddItem:return(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledDescriptionVersionAddItem"});case F.AccessItem:return(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledDescriptionVersionAccessItem"});default:return null}},P=[(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledInstructionStep1"},"totpAnotherDeviceEnrolledInstructionStep1"),(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledInstructionStep2"},"totpAnotherDeviceEnrolledInstructionStep2"),(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledInstructionStep3"},"totpAnotherDeviceEnrolledInstructionStep3")],M=e=>{var{onClose:t,hasMfaValue:o}=e,s=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(o[n[s]]=e[n[s]])}return o}(e,["onClose","hasMfaValue"]);const r=(({isAccessingTotp:e})=>(0,S.RQ)(C.bw.SETTINGS)?F.Settings:e?F.AccessItem:F.AddItem)({isAccessingTotp:o});return(0,n.jsxs)(g.lGe,Object.assign({},s,{isClosable:!0,"data-testid":"another-device-enrolled-dialog",onClose:t,children:[(0,n.jsx)(g.c75,{title:N(r)}),(0,n.jsxs)(g.R4S,{className:"px-6",children:[(0,n.jsx)(g.NE,{className:"mb-6",children:k(r)}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"mb-3 block",children:(0,n.jsx)(x.A,{id:"totpAnotherDeviceEnrolledInstruction"})}),(0,n.jsx)("ol",{className:"flex flex-col gap-3",children:P.map((e,t)=>(0,n.jsx)("li",{className:"relative [counter-increment:list] before:top-0 before:mr-3 before:inline-flex before:size-6 before:items-center before:justify-center before:rounded-full before:bg-grey-lighter before:text-center before:font-bold before:content-[counter(list)] dark:before:bg-ref-color-grey-90",children:e},`step${t+1}`))})]}),(0,n.jsx)(g.Esm,{leftActions:(0,n.jsx)(g.N_E,{href:D.U.TOTPHowToUseArticle,target:"_blank",children:(0,n.jsx)(x.A,{id:"needHelpQuestion"})}),rightActions:(0,n.jsx)(g.$nd,{"data-testid":"got-it-button",onClick:t,children:(0,n.jsx)(x.A,{id:"gotItExtension"})}),className:"pb-4 [--comp-dialog-padding-left:0] [--comp-dialog-padding-right:0]"})]})]}))};var _=o(54262);const K=({isOpen:e,itemId:t,onClose:o,isSharedItem:s})=>{const{removeFromQueue:r}=(0,w.O)(),{action:i}=(0,v.y)(m.FH.mfa.removeData,{onSuccess:()=>{(0,y.P0)(y.Et.ActionFeedback,{bodyText:(0,n.jsx)(x.A,{id:"totpRemoveSuccess"})}),r(c.q.DeleteTwoFactorCode)},onError:()=>{(0,j.$)((0,n.jsx)(x.A,{id:"totpRemoveError"})),r(c.q.DeleteTwoFactorCode)}});return(0,n.jsx)(_.a,{isDestructiveConfirmation:!0,isOpen:e,header:(0,n.jsx)(x.A,{id:"totpRemoveDialogHeader"}),content:(0,n.jsx)(()=>(0,n.jsxs)(n.Fragment,{children:[s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.A,{id:"totpRemoveBodySharedItem"})," "]}),(0,n.jsx)(x.A,{id:"totpRemoveBody"})]}),{}),action:()=>i(t),actionText:(0,n.jsx)(x.A,{id:"delete"}),"data-testid":"remove-two-factor-code-dialog",onClose:o,onCancel:o})};var V=o(31020),H=o(3124);const R=e=>{var{onClose:t}=e,o=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(o[n[s]]=e[n[s]])}return o}(e,["onClose"]);const{formatMessage:r}=(0,h.A)(),[i,a]=(0,s.useState)(!1),{action:l,isLoading:d}=(0,v.y)(m.FH.mfa.unenrollDevice,{onError:()=>(0,j.$)(r({id:"disableAuthenticatorError"})),onSuccess:()=>(0,y.P0)(y.Et.ActionFeedback,{bodyText:r({id:"disableAuthenticatorSuccess"})})}),{removeFromQueue:u}=(0,w.O)();return(0,n.jsxs)(g.lGe,Object.assign({},o,{isClosable:!i,"data-testid":"disable-authenticator-dialog",onClose:t,children:[(0,n.jsx)(g.c75,{title:(0,n.jsx)(x.A,{id:"disableAuthenticatorTitle"})}),(0,n.jsx)(g.R4S,{children:(0,n.jsx)(x.A,{id:"disableAuthenticatorDescription"})}),(0,n.jsx)(g.Esm,{rightActions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.$nd,{disabled:i,rank:"secondary",onClick:t,children:(0,n.jsx)(x.A,{id:"cancel"})}),(0,n.jsx)(g.$nd,{rank:"danger",isLoading:d,"data-testid":"turn-off",disabled:i,onClick:()=>{return t=function*(){const e=yield m.FH.internal.getDeviceID();a(!0);const t=yield(0,V.a1)(m.FH,r,H.O).finally(()=>a(!1));if(!t)throw new Error("Missing MFA keys");yield l(e,t.deviceMFASignKey),u(c.q.DisableDeviceAsAuthenticator)},new((e=void 0)||(e=Promise))(function(o,n){function s(e){try{i(t.next(e))}catch(e){n(e)}}function r(e){try{i(t.throw(e))}catch(e){n(e)}}function i(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e(function(e){e(n)})).then(s,r)}i((t=t.apply(undefined,[])).next())});var e,t},children:(0,n.jsx)(x.A,{id:"turnOff"})})]})})]}))};var q=o(92393),L=o(20990),$=o(89389),Q=o(5270),B=o(69883),G=o(54662),U=o(84992),z=o(8832),J=o.n(z),X=o(53351),Y=o(82533),W=function(e,t,o,n){return new(o||(o=Promise))(function(s,r){function i(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(i,a)}l((n=n.apply(e,t||[])).next())})};const Z=e=>{var{onClose:t,hasMfaValue:o}=e,r=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(o[n[s]]=e[n[s]])}return o}(e,["onClose","hasMfaValue"]);const i=(0,l.d4)(B.JQ),a=(0,l.d4)(e=>(0,U.Di)(e,G.SX.TotpAnnouncement)),[d,u]=(0,s.useState)(""),[p,f]=(0,s.useState)(null),[b,A]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),[O,I]=E(o),T=(0,$.$)(),F=(0,g.Lh5)(),{formatMessage:N}=(0,h.A)(),{removeFromQueue:k}=(0,w.O)(),{action:P}=(0,v.y)(m.FH.mfa.enrollDevice,{onError:()=>{throw new Error(N({id:"deviceEnrollFailureTryAgain"}))}}),M=(0,s.useCallback)(()=>W(void 0,void 0,void 0,function*(){try{yield m.FH.masterPassword.confirm(i,d)}catch(e){return void f(e.message)}const e=(()=>{const e=J().crypto_box_keypair(),t=J().to_base64(e.publicKey,J().base64_variants.ORIGINAL);return{privateKey:J().to_base64(e.privateKey,J().base64_variants.ORIGINAL),publicKey:t}})(),t=(()=>{const e=J().crypto_sign_keypair(),t=J().to_base64(e.publicKey,J().base64_variants.ORIGINAL);return{privateKey:J().to_base64(e.privateKey,J().base64_variants.ORIGINAL),publicKey:t}})(),o=yield m.FH.internal.getDeviceID();yield(0,Y.AL)({purpose:q.sT.MFAValidation,deviceMFAKey:e.privateKey,deviceMFASignKey:t.privateKey},N),yield P(o,{encryption:{publicKey:e.publicKey,privateKey:e.privateKey},signing:{publicKey:t.publicKey,privateKey:t.privateKey}}),(0,y.P0)(y.Et.Main,{bodyText:N({id:"deviceEnrollSuccess"})}),a&&!a.seen&&m.FH.notifications.markNotificationsAsSeen([a.uuid]).catch(L.f),k(c.q.EnableDeviceAsAuthenticator),C(!1)}),[i,P,N,d,k,a]),{action:_,isLoading:K}=(0,v.y)(M,{onError:e=>W(void 0,void 0,void 0,function*(){(null==e?void 0:e.name)!==q.pL.NotAllowed?((0,H.O)(Q.$.Error,"EnableDeviceAsAuthenticatorModal::api.masterPassword.confirm",e),yield m.FH.internal.clearBiometricsStorage(q.sT.MFAValidation),(0,j.$)(N({id:"deviceEnrollFailureTryAgain"})),t(),C(!1)):A(!0)})});return(0,n.jsxs)(g.lGe,Object.assign({},r,{isBorderless:!0,isClosable:!S,className:"min-h-[481px]","data-testid":"enable-authenticator-dialog",onClose:t,children:[(0,n.jsx)(g.c75,{className:"h-[191px] bg-[url('@images/backgrounds/enable-authenticator.svg?url')]",title:""}),b&&(0,n.jsx)("div",{className:"flex w-full items-center justify-center bg-[#FFE5E8] py-4",children:(0,n.jsx)("p",{className:"text-xs font-medium text-[#E33648]",children:(0,n.jsx)(x.A,{id:"failedBiometricSetup"})})}),(0,n.jsx)(g.R4S,{className:"min-h-[218px] pt-7",children:(0,n.jsx)("form",{onSubmit:e=>{e.stopPropagation(),e.preventDefault(),T?d?(F.isPasswordVisible&&F.toggleIsPasswordVisible(),_()):f(N({id:"requiredMasterPassword"})):f(N({id:"errorCode0008"}))},children:(0,n.jsxs)("fieldset",{className:"flex flex-col justify-start",disabled:K,children:[O&&I&&(0,n.jsx)("p",{className:"mb-1 text-xs font-medium text-ref-color-grey-65",children:(0,n.jsx)(x.A,{id:"stepOf",values:{currentStep:O,totalSteps:I}})}),(0,n.jsx)("span",{className:"text-xl font-bold",children:(0,n.jsx)(x.A,{id:"enableAuthenticatorTitle"})}),(0,n.jsx)("p",{className:"my-5 text-sm leading-normal",children:(0,n.jsx)(x.A,{id:o?"enableAuthenticatorOnTotpAccessModalDescription":"enableAuthenticatorModalDescription"})}),(0,n.jsx)("p",{className:"mb-3 text-sm font-bold leading-normal tracking-[-.14px]",children:(0,n.jsx)(x.A,{id:"enterMasterPasswordToContinue"})}),(0,n.jsx)(g.yAz,{autoFocus:!0,id:"password",value:d,visibility:F,label:N({id:"masterPassword"}),onChange:e=>{u(e),f(e?"":N({id:"requiredMasterPassword"}))}}),(0,n.jsx)(g.Q0g,{className:"mt-2",error:p}),(0,n.jsxs)("div",{className:"flex grow items-center justify-between py-5",children:[(0,n.jsx)(g.N_E,{onClick:()=>(0,X.k)(D.U.AuthenticatorSetupArticle),children:(0,n.jsx)(x.A,{id:"needHelpQuestion"})}),(0,n.jsx)(g.$nd,{isLoading:K,type:"submit",rank:"primary","data-testid":"confirm",disabled:S,children:(0,n.jsx)(x.A,{id:"continue"})})]})]})})})]}))};let ee=!1;const te=({callback:e,onClose:t})=>((0,s.useEffect)(()=>{ee||(ee=!0,null==e||e().finally(()=>{t(),ee=!1}))},[]),null),oe=({item:e,showTotpCodeCallback:t,copyTotpCodeCallback:o})=>{const x=(0,l.d4)(d.h),h=!!(null==e?void 0:e.has_mfa_value),y=(null==e?void 0:e.uuid)||"",j=Boolean(null==e?void 0:e.shared),{isBusiness:v}=(0,a.C)(),g=(0,i.i)(r.T.TOTPStallone),A=(0,l.d4)(u.Fb),S=(0,b.J3)(A),C=f.o&&(0,p.V)(),O=v&&S&&g&&C,{resetQueue:E}=(0,w.O)(),I=()=>{E()};switch((0,s.useEffect)(()=>{O&&m.FH.internal.checkEnrollmentStatus()},[O]),null==x?void 0:x.type){case c.q.EnableDeviceAsAuthenticator:return(0,n.jsx)(Z,{isOpen:!0,hasMfaValue:h,onClose:I});case c.q.DisableDeviceAsAuthenticator:return(0,n.jsx)(R,{isOpen:!0,onClose:I});case c.q.AnotherDeviceEnrolled:return(0,n.jsx)(M,{isOpen:!0,hasMfaValue:h,onClose:I});case c.q.ShowTwoFactorCode:return(0,n.jsx)(te,{callback:t,onClose:I});case c.q.CopyTwoFactorCode:return(0,n.jsx)(te,{callback:o,onClose:I});case c.q.AddTwoFactorCode:return(0,n.jsx)(T,{isOpen:!0,hasMfaValue:h,itemId:y,onClose:I});case c.q.DeleteTwoFactorCode:return(0,n.jsx)(K,{isOpen:!0,itemId:y,isSharedItem:j,onClose:I});default:return null}}},57025:()=>{},76447:()=>{},77667:()=>{}}]);
//# sourceMappingURL=628.chunk.js.map